# Excel VBA KNN分類ツール (汎用版)

本ツールは、Excel VBAのみで実装されたk-近傍法 (k-Nearest Neighbors) による分類プログラムです。
Python等の環境構築を必要とせず、ExcelとCSVファイルがあれば手軽に機械学習アルゴリズムを試行できます。

アヤメの品種分類（Irisデータセット）をはじめ、任意の構造を持つCSVデータに対して分類予測を行うことが可能です。

## 特徴
- **環境構築不要**: ExcelがインストールされたWindows環境であれば即座に動作します。
- **汎用的なデータ対応**: 学習データとして外部CSVファイルを読み込みます。ターゲット列（正解ラベル）を指定することで、様々なデータセットに対応可能です。
- **シンプルな操作**: ファイル選択とパラメータ入力のみで推論を実行できます。

## 動作要件
1. **Microsoft Excel** (Windows版)
2. **学習用データ (CSVファイル)**
   - 1行目にヘッダ（列名）が必要です。
   - **ターゲット列**: 分類したい正解ラベル（クラス名）を含む列。
   - **特徴量列**: ターゲット列以外の全ての列は、数値データである必要があります。

## 使用方法

### 1. モジュールのインポート
1. Excelを開き、`Alt` + `F11` キーでVBAエディタを開きます。
2. 「ファイル」>「ファイルのインポート」から `KNN.bas` を読み込みます。

### 2. マクロの実行
1. Excelのシート画面に戻り、`Alt` + `F8` キーを押します。
2. マクロ一覧から `main_generic_knn_classify` を選択し、「実行」をクリックします。

### 3. パラメータの指定
実行後、以下の順で入力を求められます。

1. **学習データの選択**: ファイル選択ダイアログでCSVファイルを指定します。
2. **ターゲット列の指定**: 正解ラベルが格納されている列名を入力します（例: `species`）。
3. **特徴量の入力**: 分類したい未知のデータ（数値）をカンマ区切りで入力します。
   - 入力例: `6.4, 3.2, 4.5, 1.5`

### 4. 結果の確認
推論結果（予測されたクラス）と、その信頼度（確信度）がメッセージボックスに表示されます。

## アルゴリズムの概要
本ツールでは、**k-近傍法 (k-NN)** を採用しています。
これは、分類したいデータに対し、特徴空間上で距離が近い（似ている）学習データを $k$ 個（本ツールでは5個）抽出し、それらの多数決によってクラスを決定する手法です。

単純な多数決ではなく、距離の逆数を用いた重み付けを行うことで、より近いデータの影響を強く反映させています。

## 注意事項
- 入力CSVファイルの文字コードはShift-JISまたはUTF-8（BOMなし）を想定しています。
- 特徴量列に数値以外のデータが含まれている場合、正しく計算されません。
- データ量が多い場合、計算に時間がかかる可能性があります（VBAでの逐次計算のため）。
